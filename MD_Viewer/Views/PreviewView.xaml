<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:MD_Viewer.ViewModels"
             x:Class="MD_Viewer.Views.PreviewView"
             x:DataType="viewmodels:PreviewViewModel">

    <Grid>
        <!-- 主要內容：WebView 顯示 HTML -->
        <!-- WebView 只在有內容且非載入狀態且無錯誤時顯示 -->
        <WebView x:Name="PreviewWebView"
                 IsVisible="{Binding ShowWebView}">
            <WebView.Source>
                <HtmlWebViewSource Html="{Binding RenderedHtml}" />
            </WebView.Source>
        </WebView>

        <!-- 載入狀態指示器 -->
        <!-- 只在載入時顯示 -->
        <ActivityIndicator IsRunning="{Binding IsLoading}"
                          IsVisible="{Binding IsLoading}"
                          HorizontalOptions="Center"
                          VerticalOptions="Center"
                          Color="{StaticResource Primary}" />

        <!-- 錯誤訊息顯示 -->
        <!-- 只在有錯誤且非載入狀態時顯示 -->
        <Label Text="{Binding ErrorMessage}"
               TextColor="Red"
               FontSize="14"
               Margin="16"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               HorizontalTextAlignment="Center">
            <Label.Triggers>
                <!-- 無錯誤時隱藏 -->
                <DataTrigger TargetType="Label" Binding="{Binding ErrorMessage, TargetNullValue=''}" Value="">
                    <Setter Property="IsVisible" Value="False" />
                </DataTrigger>
                <!-- 載入時隱藏（優先於錯誤訊息） -->
                <DataTrigger TargetType="Label" Binding="{Binding IsLoading}" Value="True">
                    <Setter Property="IsVisible" Value="False" />
                </DataTrigger>
            </Label.Triggers>
        </Label>

        <!-- 空狀態顯示 -->
        <!-- 只在無內容且非載入狀態且無錯誤時顯示 -->
        <Label Text="請選擇一個 Markdown 檔案以預覽內容"
               TextColor="{StaticResource Gray500}"
               FontSize="16"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               IsVisible="{Binding ShowEmptyState}" />
    </Grid>

</ContentView>

